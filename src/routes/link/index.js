import { h, Component } from 'preact';
import style from './style';
import Flight from '../../components/flight';


function Polyline(props) {
	return (
		<polyline id={props.id} class="letter" fill="none" stroke="#06FFF8" stroke-width={props.strokeWidth} stroke-miterlimit="10" points={props.points}  />
	)
}



export default class Link extends Component {
	constructor() {
		super();
		this.state = {
			inPlace: true,
			paths: [
				{id: "y_1", speed: 2, pointA: "1080", pointB: "1200", points: "-180.6,467.2 -147.6,486.3 -113.6,467.2  -80.6,486.3 -46.6,467.2 -46.6,429 -13.6,409.9 20.4,429 20.4,467.2 53.4,486.3 87.4,467.2 120.4,486.3 154.4,467.2 187.4,486.3  221.7,467 254.4,486.3 288.4,467.2 321.4,486.3 355.9,467.2 388.4,486.3 422.4,467.2 455.4,486.3 489.4,467.2 522.4,486.3  556.4,467.2 589.4,486.3 623.4,467.2 656.4,486.3 689.9,466.9 690.4,429 656.9,409.9 656.9,371.9 "},
				{id: "a_2", speed: 2, pointA: "845", pointB: "1100", points: "-181.1,-29.1 -181.1,9 -147.9,28.1  -113.6,9 -81.1,27.9 -81.1,66.3 -47.1,84.9 -47.1,123.5 -13.9,142.6 20.4,123.5 52.9,142.9 52.9,180.8 87.1,199.9 120.4,180.8  153.9,199.9 153.9,238.1 186.9,256.9 186.9,295.4 220.9,314.9 220.9,352.6 253.9,371.9 253.9,409.9 288.9,429.2 288.9,391  322.4,371.9 355.9,391 355.9,428.9 355.9,466.9 "},
				{id: "c_1", pointA: "0", pointB: "41", points: "556.9,429 556.9,467.2 589.4,486.3  589.4,524.5 623.4,543.6 623.4,581.7 589.4,600.8 589.4,639 555.9,658.1 556.4,696.3 589.9,715.4 "},
				{id: "f1_1", pointA: "0", pointB: "80", points: "254.9,180.7 221.4,199.9 221.4,237.9  187.4,257.2 187.4,295.4 154.4,314.5 120.4,295.4 120.4,257.2 87.4,238.1 53.4,257.2 53.4,295.4 20.4,314.5 -13.6,295.4  -46.6,314.5 -46.6,352.6 -80.6,371.7 -80.6,409.9 "},
				{id: "f3_1", pointA: "0", pointB: "80", points: "254.8,409.6 221.5,429 221.7,467  187.4,486.3 154.4,467.2 120.4,486.3 120.4,524.5 87.4,543.6 87.4,581.7 120.4,600.8 120.4,639 153.9,658.1 154.4,696.3 "},
				{id: "c_4", pointA: "0", pointB: "41", points: "556.9,429 590.6,409.9 589.4,371.7  623.4,352.6 623.4,314.5 656.4,295.4 656.4,257.2 690.4,238.1 723.4,257.2 757.4,238.1 757.4,199.9 723.4,180.8 723.4,142.6  690.4,123.5 656.4,142.6 623.4,123.5 623.4,85.4 589.4,66.3 589.4,28.1 623.4,9 623.4,-29.2 "},
				{id: "f3_2", pointA: "0", pointB: "80", points: "221.5,429 221.2,391 254.6,371.6  288.4,352.6 321.4,371.7 355.4,352.6 355.4,314.5 321.4,295.4 321.4,257.2 288.4,238.1 288.4,199.9 321.4,180.8 321.4,142.6  287.9,121.9 288.4,85.4 254.4,66.3 221.4,85.4 221.4,123.5 187.4,142.6 187.4,180.8 154.4,199.9 120.4,180.8 120.4,142.6  87.4,123.5 87.4,85.4 53.4,66.3 53.4,28.1 20.4,9 20.4,-29.2 "},
				{id: "n_1", speed: 7, pointA: "0", pointB: "240", points: "456.4,409.9 489.9,429 489.9,467.2  455.6,486.3 455.5,449.3 422.4,429 422.4,467 388.4,486.3 388.4,524.5 422.4,543.6 455.4,524.5 489.4,543.6 522.4,524.5  522.4,486.3 489.9,467.2 489.4,429 455.4,409.9 455.4,371.7 422.4,352.6 423.1,314.5 455.9,295.4 521.9,333 522.4,409.9 556.9,429  556.9,467.2 590.6,486.3 589.4,524.5 556.4,543.6 556.4,581.7 522.4,600.8 522.4,639 488.9,658.1 489.4,696.3 "},
				{id: "f2_1", pointA: "0", pointB: "40", points: "555.9,314.9 589.4,295.7 623.4,314.5  656.4,295.4 690.4,314.5 690.4,352.6 723.4,371.7 723.4,409.9 757.4,429 757.4,467.2 790.4,486.3 824.4,467.2 857.4,486.3  891.4,467.2 924.4,486.3 958.4,467.2 "},
				{id: "l_1", pointA: "0", pointB: "118", points: "321.9,257.2 288.4,238.1 288.4,161.9  321.4,142.6 355.4,123.5 355.4,85.4 321.4,66.3 321.4,28.1 355.4,9 355.4,-29.2 321.4,-48.3 288.4,-29.2 288.4,9 254.4,28.1  221.4,9 187.4,28.1 154.4,9 154.4,-29.2 120.4,-48.3 "},
				{id: "h_2", pointA: "0", pointB: "40", points: "489.4,199.9 489.4,161.9 522.4,142.6  489.4,123.5 489.4,85.4 522.4,66.3 522.4,28.1 556.4,9 556.4,-29.2 589.4,-48.3 589.4,-86.5 556.4,-105.6 "},
				{id: "t_1", pointA: "0", pointB: "75", points: "623.4,238 623.4,200 589.9,180.8  589.4,142.6 556.4,123.5 556.4,85.4 522.4,66.3 489.4,85.4 455.4,66.3 422.4,85.4 388.4,66.3 355.4,85.4 321.4,66.3 288.4,85.4  254.4,66.3 254.4,28.1 221.4,9 221.4,-29.2 254.4,-48.3 254.4,-86.5 221.4,-105.6 221.4,-143.7 187.9,-162.8 "},
				{id: "t_2", pointA: "0", pointB: "75", points: "623.3,161.9 623.3,199.9 656.3,181.9  690.4,199.9 723.4,180.8 723.4,142.6 757.4,123.5 757.4,85.4 790.4,66.3 824.4,85.4 857.4,66.3 891.4,85.4 924.4,66.3 924.4,28.1  958.4,9 "},
				{id: "s_1", speed: 7, pointA: "0", pointB: "310", points: "656.3,295.2 690.5,314.5 723.4,295.4  723.4,256.9 689.6,275.2 656.5,257.2 656.5,219.1 690.3,200 724.6,219.1 757.4,199.9 723.4,180.8 723.4,142.6 690.4,123.5  690.4,85.4 656.4,66.3 656.4,28.1 690.4,9 723.4,28.1 757.4,9 757.4,-29.2 790.4,-48.3 824.4,-29.2 857.4,-48.3 857.4,-86.5  891.4,-105.6 "},
				{id: "o_1", speed: 7, pointA: "0", pointB: "79", points: "521.9,371.2 521.2,371.6 488.9,353.2  488.9,276.7 455.4,257.2 455.4,218.1 422.4,199.9 388.4,180.8 388.4,142.6 422.4,123.5 422.4,85.4 455.4,66.3 455.4,28.1 489.4,9  489.4,-29.2 455.4,-48.3 455.4,-86.5 "},
				{id: "o_2", pointA: "0", pointB: "79", points: "489.6,314.6 521.9,333 522.4,409.9  556.4,427.9 589.4,409.9 589.4,371.7 623.4,352.6 656.4,371.7 690.4,352.6 723.4,371.7 757.4,352.6 790.4,371.7 824.4,352.6 "},
				{id: "c_2", pointA: "0", pointB: "41", points: "590.6,409.9 624.3,429 623.4,467.2  656.4,486.3 656.4,524.5 690.4,543.6 723.4,524.5 757.4,543.6 757.4,581.7 723.4,600.8 723.4,639 756.9,658.1 757.4,696.3  790.9,715.4 824.4,696.3 857.9,715.4 "},
				{id: "i_1", speed: 7, pointA: "0", pointB: "40", points: "355.4,199.9 355.4,237.9 321.4,257.2  321.4,295.4 288.4,314.5 254.4,295.4 221.4,314.5 221.4,352.6 187.4,371.7 187.4,409.9 154.4,429 120.4,409.9 120.4,371.7  87.4,352.6 53.4,371.7 53.4,409.9 87.4,429 87.4,467.2 53.4,486.3 53.4,524.5 20.4,543.6 -13.6,524.5 -13.6,486.3 -46.6,467.2  -80.6,486.3 "},
				{id: "c_3", pointA: "0", pointB: "41", points: "590.6,486.3 623.4,467.2 623.4,429  656.9,409.9 656.9,371.9 690.4,352.6 690.5,314.5 723.4,295.4 757.4,314.5 790.4,295.4 824.4,314.5 857.4,295.4 857.4,257.2  891.4,238.1 891.4,199.9 924.4,180.8 "},
				{id: "c_5", pointA: "0", pointB: "41", points: "590.6,486.3 556.9,467.2 522.4,486.3  522.4,524.5 489.4,543.6 489.4,581.7 455.4,600.8 455.4,639 421.9,658.1 388.4,639 354.9,658.1 355.4,696.3 321.9,715.4  288.4,696.3 "},
				{id: "f1_2", pointA: "0", pointB: "80", points: "254.9,142.7 221.4,161.9 221.4,199.9  221.4,238.1 254.4,257.2 254.4,295.4 288.4,314.5 288.4,352.6 254.4,371.7 254.4,409.9 221.4,429 187.4,409.9 187.4,371.7  154.4,352.6 120.4,371.7 87.4,352.6 87.4,314.5 53.4,295.4 53.4,257.2 20.4,238.1 -13.6,257.2 -46.6,238.1 -80.6,257.2  -113.6,238.1 "},
				{id: "f2_2", pointA: "0", pointB: "115", points: "589.4,257.7 555.9,276.9 555.9,352.6  522.4,371.7 522.4,409.9 489.4,429 455.4,409.9 422.4,429 422.4,467.2 388.4,486.3 388.4,524.5 355.4,543.6 355.4,581.7  321.4,600.8 321.4,639 287.9,658.1 288.4,696.3 254.9,715.4 "},
				{id: "y_2", pointA: "0", pointB: "80", points: "723.9,371.9 723.9,409.9 690.4,429  689.9,466.9 656.4,486.3 623.4,467.2 589.4,486.3 556.4,467.2 522.4,486.3 489.4,467.2 455.4,486.3 422.4,467.2 388.4,486.3  355.9,467.2 321.4,486.3 288.4,467.2 254.4,486.3 221.7,467 187.4,486.3 154.4,467.2 120.4,486.3 87.4,467.2 53.4,486.3 20.4,467.2  20.4,429 -13.6,409.9 -46.6,429 -46.6,467.2 -80.6,486.3 -113.6,467.2 -147.6,486.3 -180.6,467.2 "},
				{id: "g_1", pointA: "0", pointB: "350", points: "388.8,295.4 423.1,314.5 455.9,295.4  455.9,218.2 422.4,199.1 388.9,218.2 388.9,256.9 421.9,276 455.4,256.9 489.4,238.1 489.4,199.9 455.4,180.8 455.4,142.6  422.4,123.5 422.4,85.4 388.4,66.3 388.4,28.1 422.4,9 422.4,-29.2 388.4,-48.3 388.4,-86.5 355.4,-105.6 355.4,-143.7 "},
				{id: "h_1", pointA: "0", pointB: "155", points: "489.4,237.9 489.4,199.9 522.9,180.8  556.4,199.9 556.4,237.9 522.4,257.2 522.4,295.4 455.9,333.7 455.4,371.7 422.4,352.6 388.4,371.7 388.4,409.9 355.9,429.2  355.9,467.2 321.4,486.3 321.4,524.5 288.4,543.6 288.4,581.7 254.4,600.8 254.4,639 287.9,658.1 "},
				{id: "a_1", pointA: "0", pointB: "120", points: "355.9,429.2 322.4,448.3 288.9,428.9  288.9,466.9 254.4,486.3 254.4,524.5 221.4,543.6 221.4,581.7 187.4,600.8 187.4,639 220.9,658.1 221.4,696.3 187.9,715.4  154.4,696.3 120.9,715.4 87.4,696.3 53.9,715.4 20.4,696.3 19.9,658.1 -13.6,639 -13.6,600.8 -46.6,581.7 -80.6,600.8 -80.6,639  -114.1,658.1 -113.6,696.3 -147.1,715.4 "},
				
			]
		};

	}

	componentDidMount() {
		this.runAnim()
	}

	draw(e, i) {
		let pointA = e.pointA || '10%';
		let pointB = e.pointB || '40%';
		let speed = e.speed || 5;
		return TweenLite.fromTo("#"+e.id, speed, {drawSVG: "100% 100%"}, {drawSVG: pointA + " " + pointB, delay: (i * .1), ease: Power1.easeInOut})
		
	}

	componentWillUnmount() {
	}

	tweensInit() {
		
	}

	runAnim() {
		let newState = this.state
		if (!newState.tweens) {
			newState.tweens = newState.paths.map(function(e, i) {
				return this.draw(e, i);

			}, this);
		} else {
			newState.tweens.map((e, i)=> {
				e.reversed() ? e.play() : e.reverse()
			})
		}
		this.setState(newState)
	}

	render() {
		return (
			<Flight {...this.props} >
			<section class={style.link + ' flight ' + this.props.c.name} onClick={this.runAnim.bind(this)}  >
				<svg  class={style.link} version="1.1" id="Layer_4_copy" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 918 636"  >
				<defs>
				<pattern id="cubepat" x="1.405" y="0.7" width=".0728" height=".18" patternContentUnits="userSpaceOnUse">
				<g>
				<polygon class={style.cubeTop} points="0,60 0,60 34.6,40 0,20.1 -34.6,40.1 0,60 		"/>
				<polygon class={style.cubeRight} points="34.6,40 34.6,40 0,60 -0.1,99.8 0,99.9 34.5,79.9 		"/>
			</g>
			<g>
				<polygon class={style.cubeLeft} points="34.5,119.7 34.5,119.7 0,99.8 0,99.9 -0.1,139.7 34.5,159.6 34.5,159.6 34.5,159.6 		"/>
				<polygon class={style.cubeTop} points="34.5,119.7 34.5,119.7 69.1,99.7 34.6,79.9 0,99.8 34.5,119.7 		"/>
				<polygon class={style.cubeRight} points="69.2,99.7 69.1,99.7 34.5,119.7 34.5,159.6 34.5,159.6 69.1,139.6 		"/>
			</g>
			<g>
				<polygon class={style.cubeLeft} points="103.7,119.6 103.7,119.6 69.2,99.7 69.1,99.8 69.1,139.6 103.6,159.5 103.7,159.5 103.7,159.5 		"/>
			</g>
			<g>
				<polygon  class={style.cubeLeft} points="34.7,0.1 34.7,0.1 0.1,-19.8 0.1,-19.7 0,20.1 34.6,40 34.7,40 34.6,40 		"/>
				<polygon class={style.cubeRight} points="69.3,-19.9 69.3,-19.9 34.7,0.1 34.6,40 34.7,40 69.2,20 		"/>
			</g>
			<g>
				<polygon class={style.cubeLeft} points="69.2,59.8 69.2,59.9 34.6,40 34.6,40 34.5,79.9 69.1,99.8 69.2,99.7 69.1,99.7 		"/>
				<polygon class={style.cubeTop} points="69.2,59.8 69.2,59.8 103.8,39.9 69.3,20 34.6,40 69.2,59.9 		"/>
				<polygon class={style.cubeTop} points="34.5,4.7 34.5,4.7 69.1,-15.3 34.6,-35.1 0,-15.2 34.5,4.7 	"/>
			</g>
				</pattern>
				</defs>
				<filter id="f1" width="100%" height="100%">
					<feGaussianBlur result="blur" stdDeviation="4" />
				</filter>
				<filter id="f2" width="100%" height="100%">
					<feGaussianBlur result="blur" stdDeviation="10" />
				</filter>
				<rect class={style.cubeBG} fill="url(#cubepat)" width="100%" height="100%"/>
				{this.state.paths.map((e, i)=> {
					return <Polyline id={e.id} strokeWidth={2} points={e.points} key={i} />
				})}
				<g filter="url(#f1)">
				{this.state.paths.map((e, i)=> {
					return <Polyline id={e.id} strokeWidth={3} points={e.points} key={i} />
				})}
				</g>

				</svg>
				<script src="assets/js/TweenLite.min.js"></script>
				<script src="assets/js/DrawSVGPlugin.min.js"></script>
			</section>
			</Flight>
		);
	}
}

